<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment Gateway - Shyne</title>
    <!-- <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet"> -->
    <link rel="stylesheet" href="/stylesheets/styles.css">
</head>
<body class="min-h-screen bg-gradient-to-br from-[#f1a155] to-[#356750] flex items-center justify-center py-8">
    <div class="w-full max-w-md bg-white rounded-2xl shadow-2xl overflow-hidden">
        <div style="background: linear-gradient(to right, #fb923c, #fdba74);" class="text-white py-8 px-6 text-center">
            <h1 class="text-2xl font-bold flex  items-center justify-center gap-2">
                <i class="fas fa-lock"></i> Secure Payment
            </h1>
            <p class="mt-2 text-base">Complete your purchase securely</p>
        </div>
        <div class="p-8">
            <div class="bg-gray-100 rounded-lg py-5 px-4 mb-8 text-center">
                <div class="text-4xl font-bold text-orange-400 mb-1">₹<%= totalAmount %></div>
                <p class="text-gray-600">Total Amount to Pay</p>
            </div>
            <div class="grid gap-4 mb-8" id="paymentMethods">
                <div class="payment-method border-2 border-orange-400 bg-orange-50 rounded-lg py-3 px-4 flex items-center gap-4 cursor-pointer transition-all duration-200 ring-2 ring-orange-200"
                     onclick="selectMethod('card')" id="method-card">
                    <i class="fas fa-credit-card text-xl text-orange-400"></i>
                    <div>
                        <div class="font-semibold">Credit/Debit Card</div>
                        <p class="text-xs text-gray-500 m-0">Visa, Mastercard, RuPay</p>
                    </div>
                </div>
                <div class="payment-method border-2 border-gray-200 rounded-lg py-3 px-4 flex items-center gap-4 cursor-pointer transition-all duration-200 hover:border-orange-400 hover:bg-orange-50"
                     onclick="selectMethod('upi')" id="method-upi">
                    <i class="fas fa-mobile-alt text-xl text-orange-400"></i>
                    <div>
                        <div class="font-semibold">UPI Payment</div>
                        <p class="text-xs text-gray-500 m-0">Google Pay, PhonePe, Paytm</p>
                    </div>
                </div>
                <div class="payment-method border-2 border-gray-200 rounded-lg py-3 px-4 flex items-center gap-4 cursor-pointer transition-all duration-200 hover:border-orange-400 hover:bg-orange-50"
                     onclick="selectMethod('netbanking')" id="method-netbanking">
                    <i class="fas fa-university text-xl text-orange-400"></i>
                    <div>
                        <div class="font-semibold">Net Banking</div>
                        <p class="text-xs text-gray-500 m-0">All major banks</p>
                    </div>
                </div>
            </div>
            <form id="paymentForm">
                <div class="mb-5">
                    <label class="block mb-2 font-semibold text-gray-700">Card Number</label>
                    <input type="text" class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-orange-400 text-base transition" placeholder="1234 5678 9012 3456" maxlength="19" id="cardNumber">
                </div>
                <div class="grid grid-cols-2 gap-4 mb-5">
                    <div>
                        <label class="block mb-2 font-semibold text-gray-700">Expiry Date</label>
                        <input type="text" class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-orange-400 text-base transition" placeholder="MM/YY" maxlength="5" id="expiry">
                    </div>
                    <div>
                        <label class="block mb-2 font-semibold text-gray-700">CVV</label>
                        <input type="password" class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-orange-400 text-base transition" placeholder="123" maxlength="3" id="cvv">
                    </div>
                </div>
                <div class="mb-7">
                    <label class="block mb-2 font-semibold text-gray-700">Cardholder Name</label>
                    <input type="text" class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-orange-400 text-base transition" placeholder="John Doe" id="cardholderName">
                </div>
                <!-- <button type="submit" class="w-full bg-orange-400 text-white py-3 rounded-lg font-bold text-lg flex items-center justify-center gap-2 transition hover:from-orange-500 hover:to-orange-400 active:scale-95 disabled:opacity-60 disabled:cursor-not-allowed" id="payButton">
                    <i class="fas fa-lock"></i> Pay ₹<%= totalAmount %>
                </button> -->
                <button type="submit" class="w-full bg-orange-400 text-white py-3 rounded-lg font-bold text-lg flex items-center justify-center gap-2 transition hover:from-orange-500 hover:to-orange-400 active:scale-95 disabled:opacity-60 disabled:cursor-not-allowed" id="payButton">
                    <i class="fas fa-lock"></i> Pay ₹<%= typeof totalAmount !== 'undefined' ? totalAmount : '' %>
                </button>
            </form>
            <div class="hidden flex-col items-center mt-6" id="loading">
                <div class="w-8 h-8 border-4 border-gray-200 border-t-orange-400 rounded-full animate-spin mb-2"></div>
                <p class="text-gray-600">Processing your payment...</p>
            </div>
            <div class="hidden text-center text-green-600 font-bold mt-6" id="successMessage">
                <i class="fas fa-check-circle text-2xl"></i>
                <p class="mt-2">Payment Successful!</p>
            </div>
            <div class="hidden text-center text-red-500 font-bold mt-6" id="errorMessage">
                <i class="fas fa-times-circle text-2xl"></i>
                <p class="mt-2">Payment Failed. Please try again.</p>
            </div>
        </div>
    </div>
    <script>
        let selectedMethod = 'card';

        function selectMethod(method) {
            selectedMethod = method;
            // Remove highlight from all
            document.querySelectorAll('.payment-method').forEach(el => {
                el.classList.remove('border-orange-400', 'bg-orange-50', 'ring-2', 'ring-orange-200');
                el.classList.add('border-gray-200');
            });
            // Add highlight to selected
            const selectedEl = document.getElementById('method-' + method);
            selectedEl.classList.remove('border-gray-200');
            selectedEl.classList.add('border-orange-400', 'bg-orange-50', 'ring-2', 'ring-orange-200');
        }

        // Card number formatting
        document.getElementById('cardNumber').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\s/g, '').replace(/[^0-9]/gi, '');
            let formattedValue = value.match(/.{1,4}/g)?.join(' ') || value;
            e.target.value = formattedValue;
        });

        // Expiry date formatting
        document.getElementById('expiry').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length >= 2) {
                value = value.slice(0, 2) + '/' + value.slice(2, 4);
            }
            e.target.value = value;
        });

        // CVV only numbers
        document.getElementById('cvv').addEventListener('input', function(e) {
            e.target.value = e.target.value.replace(/\D/g, '');
        });

        // Form submission
        document.getElementById('paymentForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const payButton = document.getElementById('payButton');
            const loading = document.getElementById('loading');
            const successMessage = document.getElementById('successMessage');
            const errorMessage = document.getElementById('errorMessage');

            // Show loading
            payButton.disabled = true;
            payButton.classList.add('opacity-60', 'cursor-not-allowed');
            loading.classList.remove('hidden');
            successMessage.classList.add('hidden');
            errorMessage.classList.add('hidden');

            // Simulate payment processing
            setTimeout(() => {
                loading.classList.add('hidden');
                // Simulate success (90% success rate for demo)
                if (Math.random() > 0.1) {
                    successMessage.classList.remove('hidden');
                    // Redirect to success page after 2 seconds
                    setTimeout(() => {
                        window.location.href = '/api/dummy-payment-single-success/<%= product.id %>?amount=<%= totalAmount %>&user=<%= user._id %>';
                    }, 2000);
                } else {
                    errorMessage.classList.remove('hidden');
                    payButton.disabled = false;
                    payButton.classList.remove('opacity-60', 'cursor-not-allowed');
                }
            }, 3000);
        });
    </script>
</body>
</html>